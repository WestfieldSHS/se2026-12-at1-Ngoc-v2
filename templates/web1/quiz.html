<!doctype html>
<!-- Declares this as an HTML5 document -->
<html lang="en">
  <!-- Sets language to English -->
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Filter Tutors</title>
    <link rel="icon" href="/static/images/icon.png" type="image/png" />
    <link rel="manifest" href="/static/manifest.json" />
    <link rel="stylesheet" href="/static/css/style.css" />
  </head>
  <body>
    <header class="navbar">
      <!-- Fixed Navbar Structure -->
      <div class="nav-left">
        <div class="logo">
          <img
            src="/static/images/icon.png"
            alt="TutorMatch Logo"
            height="50"
          />
        </div>
        <!-- Filter dropdown included in nav-left for consistency -->
        <div class="search-bar">
          <select id="traitFilter" onchange="filterByTrait()">
            <option value="">-- All Traits --</option>
            {% for trait in traits %}
            <option value="{{ trait[1] }}">{{ trait[1] }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <!-- Hamburger Menu Button -->
      <button
        class="menu-toggle"
        aria-label="Open navigation menu"
        onclick="toggleMenu()"
      >
        <span class="bar"></span>
        <span class="bar"></span>
        <span class="bar"></span>
      </button>

      <!-- Navigation Links -->
      <nav class="nav-links" id="navLinks" aria-label="Main Site Navigation">
        <a href="/">Main Menu</a>
        <a href="/account">Apply Now</a>
        <a href="/about">About Us</a>
      </nav>
    </header>

    <main class="hero">
      <h1>Select Your Tutor</h1>
      <p>
        Pick a trait to filter. <strong>Tip:</strong> If you don't want a trait,
        select a different one.
      </p>

      <form action="/final" method="POST">
        <input type="hidden" name="fullname" value="{{ fullname }}" />
        <input type="hidden" name="email" value="{{ email }}" />
        <input type="hidden" name="username" value="{{ username }}" />
        <input type="hidden" name="password" value="{{ password }}" />
        <input type="hidden" name="course_id" value="{{ course_id }}" />
        <input type="hidden" name="time" value="{{ time }}" />

        <div class="tutor-grid">
          {% for tutor in tutors %}
          <div class="tutor-card" data-traits="{{ tutor['traits'] }}">
            <h3>{{ tutor['full_name'] }}</h3>
            <p><strong>Learning Styles:</strong> {{ tutor['traits'] }}</p>
            <input
              type="radio"
              name="selected_tutor_id"
              value="{{ tutor['tutor_id'] }}"
              required
            />
          </div>
          {% endfor %}
        </div>
        <button type="submit" class="btn" style="margin-top: 20px">
          Confirm Registration
        </button>
      </form>
    </main>

    <footer class="footer">
      <p>Not sure about something? <strong>Contact us!</strong></p>
      <p>Phone: 0400 000 000 | Email: info@tutors.com</p>
    </footer>

    <script>
      function filterByTrait() {
        let selectedTrait = document.getElementById("traitFilter").value;
        let cards = document.getElementsByClassName("tutor-card");
        for (let i = 0; i < cards.length; i++) {
          let tutorTraits = cards[i].getAttribute("data-traits");
          if (selectedTrait === "" || tutorTraits.includes(selectedTrait)) {
            cards[i].style.display = "";
          } else {
            cards[i].style.display = "none";
          }
        }
      }

      function toggleMenu() {
        const nav = document.getElementById("navLinks");
        nav.classList.toggle("active");
      }
    </script>
  </body>
</html>
